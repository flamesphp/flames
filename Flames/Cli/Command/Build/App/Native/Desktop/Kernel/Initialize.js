// Autogenerated by Flames
// Github: https://github.com/flamesphp/flames
// Docs:   https://flamesphp.com

const flames = require('./Flames');
const electron = require("electron");
const env = require("../env");
const window = require("./BrowserWindow");
const { BrowserView } = electron;
const { app, Menu } = require('electron');
const initialize = require('./Initialize');

exports.initialize = (view) => {

    view.webContents.setWindowOpenHandler((details) => {

        var popupWindow = window.getBrowserWindow(app);

        return {
            action: 'allow',
            createWindow: (options) => {
                const browserView = new BrowserView(options)
                popupWindow.addBrowserView(browserView)

                const contentBounds = popupWindow.getContentBounds();
                browserView.setBounds({ x: 0, y: 0, width: contentBounds.width, height: contentBounds.height });
                browserView.setAutoResize({ width: true, height: true });

                initialize.initialize(browserView);

                return browserView.webContents
            }
        }
    })


    view.webContents.on('did-navigate', (event, input) => {
        flames.inject(view);
    });

    // webContents.on('will-navigate', function(event, url) {
    //     if (isExternal(url)) {
    //         event.preventDefault();
    //         openInExternalPage(url);
    //     }
    // });

    //contents.reloadIgnoringCache();
};